<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FORM</title>
    <style>
        table,th,td {
            border: 1px solid;
        }

        table {
            width: 100%;
        }
        input {
            width: 50%;
            height: 30px;
            margin: 10px;
            padding: 10px;
        }
    </style>
</head>

<body>
    <button onclick="ClickAble()">add student</button>
    <div id="box">  
         <form action="http://localhost:8000" method="post" id="forms">
        <input type="text" name="name">
        <input type="number" name="age">
        <input type="submit" name="add">
        
    </form>
    <button onclick="Cancel()">cancel</button>
</div>
 

    
    <script>
        function ClickAble() {
            const box =document.getElementById("box")
            box.style.display="block"
        }
        function Cancel() {
            const box =document.getElementById("box")
            box.style.display="none"
        }

        const form=document.getElementById("forms")
        form.addEventListener("submit",async function(e){
            e.preventDefault()
            const inputs =document.getElementsByTagName("input")
            const nameInput =inputs[0]
            const ageInput =inputs[1]
            try{
                const res=await fetch('http://localhost:8000',{
                    method:"POST",
                    body: JSON.stringify({
                        name:nameInput.value,
                        age:ageInput.value

                    })
                })
                const result=await res.json()
                console.log(result)
            }
            catch(e){
                console.log(e)
            }
            
        })


        window.onload = async function () {
            const data = await fetch("http://localhost:8000")
            const result = await data.json()
            const table = document.createElement("table")
            const thead = document.createElement("thead")
            const tbody = document.createElement("tbody")
            const rows = document.createElement("tr")
                const id = document.createElement("th")
                const name = document.createElement("th")
                const age = document.createElement("th")
                id.textContent = "ID"
                name.textContent = "NAME"
                age.textContent = "AGE"
                rows.appendChild(id)
                rows.appendChild(name)
                rows.appendChild(age)
                thead.appendChild(rows)
            for (let i = 0; i < result.length; i++) {
                const row = document.createElement("tr")
                const id = document.createElement("td")
                const name = document.createElement("td")
                const age = document.createElement("td")
                id.textContent = result[i]._id
                name.textContent = result[i].name
                age.textContent = result[i].age
                row.appendChild(id)
                row.appendChild(name)
                row.appendChild(age)
                tbody.appendChild(row)
                console.log(row)
            }
            table.appendChild(tbody)
            table.appendChild(thead)
            document.body.appendChild(table)
        }
    </script>

</body>

</html>